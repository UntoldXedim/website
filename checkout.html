<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout — Supplement Store</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --green:#28a745; --green-dark:#1f7a36; --border:#e9ecef; --bg:#f8f9fa;
      --muted:#666; --radius:10px; --shadow:0 2px 6px rgba(0,0,0,.08);
      --btn-h:40px;
    }
    *{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
    body{margin:0;background:var(--bg);color:#222}
    /* header */
    header{background:#fff;border-bottom:1px solid var(--border)}
    .nav{max-width:1100px;margin:0 auto;padding:1rem;display:flex;
         align-items:center;justify-content:space-between}
    .brand{font-weight:700}
    /* layout */
    .wrap{max-width:1100px;margin:1.25rem auto;padding:0 1rem;
          display:grid;gap:1rem;grid-template-columns:2fr 1fr}
    @media(max-width:900px){.wrap{grid-template-columns:1fr}}
    /* cards */
    .card{background:#fff;border:1px solid var(--border);
          border-radius:var(--radius);box-shadow:var(--shadow)}
    .card h2{margin:0;padding:1rem;border-bottom:1px solid var(--border);
             font-size:1.1rem}
    .card .content{padding:1rem}
    /* cart rows */
    .cart-line{display:flex;gap:.75rem;align-items:center;
               border-bottom:1px solid #f3f3f3;padding:.6rem 0}
    .cart-line:last-child{border-bottom:none}
    .cart-line img{width:56px;height:56px;object-fit:cover;
                   border:1px solid #eee;border-radius:6px}
    .cart-main{flex:1}
    .muted{color:var(--muted);font-size:.92rem}
    /* qty buttons */
    .qty{display:flex;align-items:center;gap:.4rem;margin-top:.35rem}
    .qty button{width:32px;height:32px;border:1px solid #ddd;
                background:#fff;border-radius:4px;cursor:pointer;
                font-size:1rem;line-height:1}
    /* form + buttons */
    .row{display:flex;gap:.5rem;align-items:center}
    .row>*{flex:1}
    input[type=text],input[type=email],input[type=password]{
      width:100%;padding:.6rem;border:1px solid #ccc;border-radius:6px}
    .btn{display:inline-flex;align-items:center;justify-content:center;
         height:var(--btn-h);padding:0 .9rem;border-radius:6px;border:none;
         background:var(--green);color:#fff;cursor:pointer}
    .btn:hover{background:var(--green-dark)}
    .btn-outline{display:inline-flex;align-items:center;justify-content:center;
         height:var(--btn-h);padding:0 .9rem;border-radius:6px;
         border:1px solid var(--green);color:var(--green);background:#fff}
    .btn-outline:hover{background:#f6fff8}
    .totals{display:flex;align-items:center;justify-content:space-between;
            margin:.6rem 0 1rem}
    .stack{display:flex;flex-direction:column;gap:.6rem}
    .notice{background:#fff7e6;border:1px solid #ffe4b5;
            padding:.7rem;border-radius:6px;color:#7a5a00}
  </style>
</head>
<body>

<div class="navbar-brand">
    <a href="index.html" style="text-decoration: none; color: inherit;">
        <h2>Supplement Store</h2>
    </a>
</div>

<main class="wrap">
  <!-- cart -->
  <section class="card">
    <h2>Your Cart</h2>
    <div id="cartList" class="content"></div>
  </section>

  <!-- sidebar -->
  <aside class="card">
    <h2>Checkout</h2>
    <div class="content">
      <!-- coupon -->
      <div class="stack" style="margin-bottom:1rem">
        <label for="coupon"><strong>Coupon code</strong></label>
        <div class="row">
          <input id="coupon" type="text" placeholder="Enter coupon code">
          <button id="applyCoupon" class="btn">Apply</button>
        </div>
        <div id="couponMsg" class="muted"></div>
      </div>
      <!-- auth options -->
      <div class="stack" style="margin-bottom:1rem">
        <strong>Checkout as:</strong>
        <div class="row">
          <button id="guestBtn" class="btn">Guest</button>
          <a href="/login.html" class="btn-outline" style="text-align:center">Log In</a>
        </div>
        <a href="/signup.html" class="btn-outline" style="text-align:center;
           margin-top:.5rem;display:block">Create Account</a>
      </div>
      <div class="notice">Demo only — wire to PayPal / Stripe / Amazon Pay.</div>
      <!-- totals -->
      <div class="totals">
        <div>Subtotal</div><div>$<span id="subtotal">0.00</span></div>
      </div>
      <div class="totals">
        <div>Discount</div><div>− $<span id="discount">0.00</span></div>
      </div>
      <div class="totals" style="border-top:1px solid #eee;padding-top:.6rem">
        <strong>Total</strong><strong>$<span id="grandTotal">0.00</span></strong>
      </div>
      <!-- pay buttons -->
      <div class="stack" style="margin-top:1rem">
        <button id="payNow"    class="btn">Credit/Debit</button>
        <button id="crypto"    class="btn">Crypto (BTC/ETH) (10% off) </button>
        <button id="paypalBtn" class="btn" style="background:#0070ba">
          Checkout with PayPal
        </button>
        <button id="amazonBtn" class="btn"
                style="background:#ff9900;color:#111">
          Amazon Pay
        </button>
      </div>
    </div>
  </aside>
</main>

<script>
  /* ---------- load saved cart ---------- */
  let cart = [];
  try { cart = JSON.parse(localStorage.getItem('cart') || '[]'); }
  catch { cart = []; }

  /* ---------- coupon rules ---------- */
  const coupons = {
    'SAVE10': {type:'percent', value:10},
    'SAVE20': {type:'amount',  value:20}
  };
  let appliedCoupon = null;

  /* ---------- DOM refs ---------- */
  const cartList      = document.getElementById('cartList');
  const subtotalEl    = document.getElementById('subtotal');
  const discountEl    = document.getElementById('discount');
  const grandTotalEl  = document.getElementById('grandTotal');
  const couponInput   = document.getElementById('coupon');
  const couponMsg     = document.getElementById('couponMsg');

  /* ---------- render cart ---------- */
  function renderCart(){
    cartList.innerHTML = '';
    if (cart.length === 0){
      cartList.innerHTML =
        '<p class="muted">Your cart is empty. <a href=\"/\">Shop</a>.</p>';
    }
    cart.forEach(item=>{
      const row = document.createElement('div');
      row.className = 'cart-line';
      row.innerHTML = `
        <img src="${item.img}" alt="${item.dose}">
        <div class="cart-main">
          <div><strong>${item.dose}</strong></div>
          <div class="muted">$${item.price.toFixed(2)} each</div>
          <div class="qty">
            <button onclick="changeQty('${item.id}',-1)">−</button>
            <div>${item.qty}</div>
            <button onclick="changeQty('${item.id}',1)">+</button>
          </div>
        </div>
        <div><strong>$${(item.price*item.qty).toFixed(2)}</strong></div>`;
      cartList.appendChild(row);
    });
    updateTotals();
  }

  function changeQty(id, delta){
    const it = cart.find(x=>x.id===id);
    if (!it) return;
    it.qty += delta;
    if (it.qty <= 0) cart = cart.filter(x=>x.id!==id);
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
  }

  /* ---------- totals ---------- */
  function getSubtotal(){
    return cart.reduce((s,i)=>s+i.price*i.qty,0);
  }
  function getDiscount(subtotal){
    if (!appliedCoupon) return 0;
    const c = coupons[appliedCoupon];
    if (!c) return 0;
    return c.type==='percent' ? subtotal*c.value/100
                              : Math.min(c.value, subtotal);
  }
  function updateTotals(){
    const sub = getSubtotal();
    const dis = getDiscount(sub);
    const grand = Math.max(0, sub - dis);
    subtotalEl.textContent = sub.toFixed(2);
    discountEl.textContent = dis.toFixed(2);
    grandTotalEl.textContent = grand.toFixed(2);
  }

  /* ---------- coupon apply ---------- */
  document.getElementById('applyCoupon').onclick = () =>{
    const code = couponInput.value.trim().toUpperCase();
    if (!code){ couponMsg.textContent = 'Enter a code.'; return; }
    if (!coupons[code]){
      couponMsg.textContent = 'Invalid or expired.'; appliedCoupon=null;
    } else {
      appliedCoupon = code; couponMsg.textContent = `Applied ${code}.`;
    }
    updateTotals();
  };

  /* ---------- demo buttons ---------- */
  document.getElementById('guestBtn').onclick   =
    () => alert('Guest checkout selected.');
  document.getElementById('payNow').onclick     =
    () => alert('Replace with real payment integration.');
  document.getElementById('crypto').onclick     =
    () => alert('Replace with real payment integration.');
  document.getElementById('paypalBtn').onclick  =
    () => alert('Insert PayPal Smart Buttons.');
  document.getElementById('amazonBtn').onclick  =
    () => alert('Insert Amazon Pay button.');

  renderCart();
</script>
</body>
</html>
